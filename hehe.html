<!DOCTYPE html>
<html>
<body>

<script>
  let totalWindows = 5; // Number of bouncing windows
  let windows = []; // Store window references
  let imageUrl = "https://via.placeholder.com/100"; // Change to your image URL
  let windowSize = 150; // Ensure all windows are uniform size

  function openBouncingWindow(index, x = 100, y = 100, dx = 5, dy = 5) {
    let myWindow = window.open("", `_blank`, `width=${windowSize},height=${windowSize},left=${x},top=${y}`);

    if (myWindow) {
      windows.push(myWindow); // Store reference

      myWindow.document.write(`
        <html>
          <head>
            <title>Bouncing Window ${index + 1}</title>
            <script>
              let x = ${x};
              let y = ${y};
              let dx = ${dx};
              let dy = ${dy};
              let gravity = 0.5;
              let isDragging = false;
              let lastX = 0, lastY = 0;
              let screenW = window.screen.availWidth;
              let screenH = window.screen.availHeight;
              let winSize = ${windowSize};

              function moveWindow() {
                if (!isDragging) {
                  dy += gravity; // Apply gravity
                  x += dx;
                  y += dy;

                  // Bounce off walls
                  if (x + winSize >= screenW || x <= 0) dx *= -1;
                  if (y + winSize >= screenH) {
                    y = screenH - winSize;
                    dy *= -1; // Reverse velocity perfectly (no energy loss)
                  }
                  if (y <= 0) {
                    y = 0;
                    dy *= -1;
                  }

                  window.moveTo(x, y);
                }
              }

              setInterval(moveWindow, 30);

              // Drag and fling behavior
              window.addEventListener("mousedown", (e) => {
                isDragging = true;
                lastX = e.screenX;
                lastY = e.screenY;
              });

              window.addEventListener("mousemove", (e) => {
                if (isDragging) {
                  let deltaX = e.screenX - lastX;
                  let deltaY = e.screenY - lastY;
                  x += deltaX;
                  y += deltaY;
                  window.moveTo(x, y);
                  lastX = e.screenX;
                  lastY = e.screenY;
                  dx = deltaX * 0.4; // Fling effect (multiplier controls speed)
                  dy = deltaY * 0.4;
                }
              });

              window.addEventListener("mouseup", () => {
                isDragging = false;
              });
            <\/script>
          </head>
          <body style="margin:0; display:flex; justify-content:center; align-items:center; background:black;">
            <img src="${imageUrl}" style="width:100px; height:100px;">
          </body>
        </html>
      `);
      myWindow.document.close();
    } else {
      alert("Pop-ups are blocked! Allow pop-ups and try again.");
    }
  }

  // Open 5 bouncing windows with identical sizes
  for (let i = 0; i < totalWindows; i++) {
    let startX = Math.random() * (window.screen.availWidth - windowSize);
    let startY = Math.random() * (window.screen.availHeight / 2);
    let velocityX = (Math.random() > 0.5 ? 1 : -1) * (3 + Math.random() * 3);
    let velocityY = -(3 + Math.random() * 5); // Start with upward motion

    openBouncingWindow(i, startX, startY, velocityX, velocityY);
  }
</script>

</body>
</html>
